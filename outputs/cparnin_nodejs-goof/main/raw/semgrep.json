{"version":"1.140.0","results":[{"check_id":"dockerfile.security.missing-user-entrypoint.missing-user-entrypoint","path":"/Users/chad.parnin/repos/nodejs-goof/Dockerfile","start":{"line":13,"col":1,"offset":195},"end":{"line":13,"col":28,"offset":222},"extra":{"metavars":{"$...VARS":{"start":{"line":13,"col":12,"offset":206},"end":{"line":13,"col":28,"offset":222},"abstract_content":"[\"npm\"\"start\"]"}},"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nENTRYPOINT [\"npm\", \"start\"]","metadata":{"cwe":["CWE-269: Improper Privilege Management"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user-entrypoint.missing-user-entrypoint","shortlink":"https://sg.run/k281","semgrep.dev":{"rule":{"origin":"community","r_id":47272,"rule_id":"ReUW9E","rv_id":945268,"url":"https://semgrep.dev/playground/r/K3TJbJg/dockerfile.security.missing-user-entrypoint.missing-user-entrypoint","version_id":"K3TJbJg"}}},"severity":"ERROR","fingerprint":"48f767cbee2fa7d6274d3b77a43da4843abadd7aad79c0d679a732ed1899b57f0288c02cf9aca303ee1f3db6ddb6a314c7bf219060d41aead6908b2c6a86be57_0","lines":"ENTRYPOINT [\"npm\", \"start\"]","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":28,"col":5,"offset":761},"end":{"line":28,"col":20,"offset":776},"extra":{"metavars":{"$APP":{"start":{"line":28,"col":5,"offset":761},"end":{"line":28,"col":8,"offset":764},"abstract_content":"app"},"$EXPRESS":{"start":{"line":28,"col":11,"offset":767},"end":{"line":28,"col":18,"offset":774},"abstract_content":"express"}},"message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.","metadata":{"category":"security","references":["https://www.npmjs.com/package/csurf","https://www.npmjs.com/package/csrf","https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-352: Cross-Site Request Forgery (CSRF)"],"owasp":["A01:2021 - Broken Access Control"],"technology":["javascript","typescript","express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site Request Forgery (CSRF)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","shortlink":"https://sg.run/BxzR","semgrep.dev":{"rule":{"origin":"community","r_id":22551,"rule_id":"wdUKEq","rv_id":945789,"url":"https://semgrep.dev/playground/r/NdTqkvB/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","version_id":"NdTqkvB"}}},"severity":"INFO","fingerprint":"0ca2ac6b959f7c5907d739b98e5b297c8c2abb85c1aa4bb6d35f9009eedb0bce0fbdc8deef3d6adc336f5ebe0a5ff3152dc52621edc463f7501b3e44c6db188e_0","lines":"var app = express();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":42,"col":9,"offset":1190},"end":{"line":46,"col":3,"offset":1275},"extra":{"metavars":{"$SESSION":{"start":{"line":42,"col":9,"offset":1190},"end":{"line":42,"col":16,"offset":1197},"abstract_content":"session","propagated_value":{"svalue_start":{"line":16,"col":15,"offset":342},"svalue_end":{"line":16,"col":41,"offset":368},"svalue_abstract_content":"require('express-session')"}}},"message":"Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next.","metadata":{"cwe":["CWE-522: Insufficiently Protected Credentials"],"owasp":["A02:2017 - Broken Authentication","A04:2021 - Insecure Design"],"source-rule-url":"https://expressjs.com/en/advanced/best-practice-security.html","category":"security","technology":["express"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain","shortlink":"https://sg.run/rd41","semgrep.dev":{"rule":{"origin":"community","r_id":9269,"rule_id":"ZqU5Pn","rv_id":945794,"url":"https://semgrep.dev/playground/r/e1T98Yy/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-domain","version_id":"e1T98Yy"}}},"severity":"WARNING","fingerprint":"53806f7a6b640867a88fc8298981e9de50ba29708dc90827c575e55edd5fd335396d8173ce5d323052f8950a22b678413f5a98595fb07239052a390ffbd1608b_0","lines":"app.use(session({\n  secret: 'keyboard cat',\n  name: 'connect.sid',\n  cookie: { path: '/' }\n}))","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":42,"col":9,"offset":1190},"end":{"line":46,"col":3,"offset":1275},"extra":{"metavars":{"$SESSION":{"start":{"line":42,"col":9,"offset":1190},"end":{"line":42,"col":16,"offset":1197},"abstract_content":"session"}},"message":"Default session middleware settings: `expires` not set. Use it to set expiration date for persistent cookies.","metadata":{"cwe":["CWE-522: Insufficiently Protected Credentials"],"owasp":["A02:2017 - Broken Authentication","A04:2021 - Insecure Design"],"source-rule-url":"https://expressjs.com/en/advanced/best-practice-security.html","category":"security","technology":["express"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires","shortlink":"https://sg.run/N4eG","semgrep.dev":{"rule":{"origin":"community","r_id":9271,"rule_id":"EwU2DZ","rv_id":945796,"url":"https://semgrep.dev/playground/r/d6TPjO8/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-expires","version_id":"d6TPjO8"}}},"severity":"WARNING","fingerprint":"b9a5fe19dc47a2c18879269ad9417b0f4da118bef3b59fa7c82540454433565870833c695760a4c81ea169bd466569e5f0a27e63c3bf1f977c2daa3367005393_0","lines":"app.use(session({\n  secret: 'keyboard cat',\n  name: 'connect.sid',\n  cookie: { path: '/' }\n}))","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":42,"col":9,"offset":1190},"end":{"line":46,"col":3,"offset":1275},"extra":{"metavars":{"$SESSION":{"start":{"line":42,"col":9,"offset":1190},"end":{"line":42,"col":16,"offset":1197},"abstract_content":"session"}},"message":"Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.","metadata":{"cwe":["CWE-522: Insufficiently Protected Credentials"],"owasp":["A02:2017 - Broken Authentication","A04:2021 - Insecure Design"],"source-rule-url":"https://expressjs.com/en/advanced/best-practice-security.html","category":"security","technology":["express"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly","shortlink":"https://sg.run/ydBO","semgrep.dev":{"rule":{"origin":"community","r_id":9268,"rule_id":"d8UjGo","rv_id":945793,"url":"https://semgrep.dev/playground/r/O9TX3Ad/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-httponly","version_id":"O9TX3Ad"}}},"severity":"WARNING","fingerprint":"500961ddc636ca00c082df52cc369918700e212af87e18d3c60fd950b4c2827a65f6566d949a6f2f00ad1a3ae8a8eac48ad620e33bd69bdb55b185ff0285ad61_0","lines":"app.use(session({\n  secret: 'keyboard cat',\n  name: 'connect.sid',\n  cookie: { path: '/' }\n}))","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":42,"col":9,"offset":1190},"end":{"line":46,"col":3,"offset":1275},"extra":{"metavars":{"$SESSION":{"start":{"line":42,"col":9,"offset":1190},"end":{"line":42,"col":16,"offset":1197},"abstract_content":"session","propagated_value":{"svalue_start":{"line":16,"col":15,"offset":342},"svalue_end":{"line":16,"col":41,"offset":368},"svalue_abstract_content":"require('express-session')"}}},"message":"Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS.","metadata":{"cwe":["CWE-522: Insufficiently Protected Credentials"],"owasp":["A02:2017 - Broken Authentication","A04:2021 - Insecure Design"],"source-rule-url":"https://expressjs.com/en/advanced/best-practice-security.html","category":"security","technology":["express"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"LOW","confidence":"MEDIUM","references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure","shortlink":"https://sg.run/9oKz","semgrep.dev":{"rule":{"origin":"community","r_id":9267,"rule_id":"v8Unzw","rv_id":945792,"url":"https://semgrep.dev/playground/r/xyTqnlZ/javascript.express.security.audit.express-cookie-settings.express-cookie-session-no-secure","version_id":"xyTqnlZ"}}},"severity":"WARNING","fingerprint":"04202a3d3de29f4fe992023f8b79cd881e6de2555cf5f44167d58620a89c6eb66631014b467c01678afd9fbe3bc29f8710df1b8efba022d714a56faabb06d916_0","lines":"app.use(session({\n  secret: 'keyboard cat',\n  name: 'connect.sid',\n  cookie: { path: '/' }\n}))","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.express-session-hardcoded-secret.express-session-hardcoded-secret","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":43,"col":3,"offset":1202},"end":{"line":43,"col":25,"offset":1224},"extra":{"metavars":{"$APP":{"start":{"line":42,"col":1,"offset":1182},"end":{"line":42,"col":4,"offset":1185},"abstract_content":"app","propagated_value":{"svalue_start":{"line":28,"col":11,"offset":767},"svalue_end":{"line":28,"col":20,"offset":776},"svalue_abstract_content":"express()"}},"$SESSION":{"start":{"line":42,"col":9,"offset":1190},"end":{"line":42,"col":16,"offset":1197},"abstract_content":"session"},"$Y":{"start":{"line":43,"col":12,"offset":1211},"end":{"line":43,"col":24,"offset":1223},"abstract_content":"keyboard cat"}},"message":"A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).","metadata":{"interfile":true,"cwe":["CWE-798: Use of Hard-coded Credentials"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"],"owasp":["A07:2021 - Identification and Authentication Failures"],"category":"security","technology":["express","secrets"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Hard-coded Secrets"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-session-hardcoded-secret.express-session-hardcoded-secret","shortlink":"https://sg.run/LYvG","semgrep.dev":{"rule":{"origin":"community","r_id":22083,"rule_id":"10Uo39","rv_id":945804,"url":"https://semgrep.dev/playground/r/QkTZzR3/javascript.express.security.audit.express-session-hardcoded-secret.express-session-hardcoded-secret","version_id":"QkTZzR3"}}},"severity":"WARNING","fingerprint":"61a0d72baedbcb238a21b010ad6f667fdeef010db40789586d92e948aa341f63835bfe914fdaf1970e062b96fe70e92814db94dd6eecd2349f8931007f72d58a_0","lines":"  secret: 'keyboard cat',","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"problem-based-packs.insecure-transport.js-node.using-http-server.using-http-server","path":"/Users/chad.parnin/repos/nodejs-goof/app.js","start":{"line":86,"col":1,"offset":2507},"end":{"line":86,"col":5,"offset":2511},"extra":{"metavars":{"$HTTP":{"start":{"line":86,"col":1,"offset":2507},"end":{"line":86,"col":5,"offset":2511},"abstract_content":"http"},"$FUNC":{"start":{"line":86,"col":6,"offset":2512},"end":{"line":86,"col":18,"offset":2524},"abstract_content":"createServer"}},"message":"Checks for any usage of http servers instead of https servers. Encourages the usage of https protocol instead of http, which does not have TLS and is therefore unencrypted. Using http can lead to man-in-the-middle attacks in which the attacker is able to read sensitive information.","metadata":{"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","category":"security","cwe":"CWE-319: Cleartext Transmission of Sensitive Information","owasp":["A02:2021 - Cryptographic Failures","A03:2017 - Sensitive Data Exposure"],"references":["https://nodejs.org/api/http.html#http_class_http_agent","https://groups.google.com/g/rubyonrails-security/c/NCCsca7TEtY"],"subcategory":["audit"],"technology":["node.js"],"vulnerability":"Insecure Transport","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/problem-based-packs.insecure-transport.js-node.using-http-server.using-http-server","shortlink":"https://sg.run/x1zL","semgrep.dev":{"rule":{"origin":"community","r_id":9430,"rule_id":"7KUQAE","rv_id":946074,"url":"https://semgrep.dev/playground/r/WrTEo9B/problem-based-packs.insecure-transport.js-node.using-http-server.using-http-server","version_id":"WrTEo9B"}}},"severity":"WARNING","fingerprint":"25ea72aeb70af0daa66b78f1bdae56381fe1301015989c4eb2ea3c00dde1eb375c47a08ed37437be5fe5a7bd03ba40dceaff8a313dd8214fb9d450fcffdb6cd3_0","lines":"http.createServer(app).listen(app.get('port'), function () {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.no-new-privileges.no-new-privileges","path":"/Users/chad.parnin/repos/nodejs-goof/docker-compose.yml","start":{"line":15,"col":3,"offset":221},"end":{"line":15,"col":13,"offset":231},"extra":{"metavars":{"$SERVICE":{"start":{"line":15,"col":3,"offset":221},"end":{"line":15,"col":13,"offset":231},"abstract_content":"goof-mongo"}},"message":"Service 'goof-mongo' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges","shortlink":"https://sg.run/0n8q","semgrep.dev":{"rule":{"origin":"community","r_id":10054,"rule_id":"qNUoWr","rv_id":947034,"url":"https://semgrep.dev/playground/r/o5TZz4P/yaml.docker-compose.security.no-new-privileges.no-new-privileges","version_id":"o5TZz4P"}}},"severity":"WARNING","fingerprint":"eca697f60fb98a4ba16584a832fc76efd913d8aa108b0c9fac7fc0e9da7532ddb635cab8a61f20d252f7d9f9797f9a50c8fb3043420beda06060ea6e6ffe618b_0","lines":"  goof-mongo:","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","path":"/Users/chad.parnin/repos/nodejs-goof/docker-compose.yml","start":{"line":15,"col":3,"offset":221},"end":{"line":15,"col":13,"offset":231},"extra":{"metavars":{"$SERVICE":{"start":{"line":15,"col":3,"offset":221},"end":{"line":15,"col":13,"offset":231},"abstract_content":"goof-mongo"}},"message":"Service 'goof-mongo' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir","https://blog.atomist.com/security-of-docker-kubernetes/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","shortlink":"https://sg.run/e4JE","semgrep.dev":{"rule":{"origin":"community","r_id":10132,"rule_id":"v8U5vN","rv_id":947038,"url":"https://semgrep.dev/playground/r/X0TLZd0/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","version_id":"X0TLZd0"}}},"severity":"WARNING","fingerprint":"f457b8d8267ff3a20ed9325370b62bffbe5f79ec6b19b33578cef114deaaa96006b86095693c0b02d1ce58fb7857c8bd12e63e505d68087d5ee24dc879c3fbda_0","lines":"  goof-mongo:","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.no-new-privileges.no-new-privileges","path":"/Users/chad.parnin/repos/nodejs-goof/docker-compose.yml","start":{"line":20,"col":3,"offset":318},"end":{"line":20,"col":13,"offset":328},"extra":{"metavars":{"$SERVICE":{"start":{"line":20,"col":3,"offset":318},"end":{"line":20,"col":13,"offset":328},"abstract_content":"good-mysql"}},"message":"Service 'good-mysql' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges","shortlink":"https://sg.run/0n8q","semgrep.dev":{"rule":{"origin":"community","r_id":10054,"rule_id":"qNUoWr","rv_id":947034,"url":"https://semgrep.dev/playground/r/o5TZz4P/yaml.docker-compose.security.no-new-privileges.no-new-privileges","version_id":"o5TZz4P"}}},"severity":"WARNING","fingerprint":"041f257abaf8cd8f2aa2eb7919756f236b24b280151671c74e5e9019f0f57adebead469fb0bc156068e7614471407eb6d2b8f3cbd430481d4b508c0575e5ec08_0","lines":"  good-mysql:","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","path":"/Users/chad.parnin/repos/nodejs-goof/docker-compose.yml","start":{"line":20,"col":3,"offset":318},"end":{"line":20,"col":13,"offset":328},"extra":{"metavars":{"$SERVICE":{"start":{"line":20,"col":3,"offset":318},"end":{"line":20,"col":13,"offset":328},"abstract_content":"good-mysql"}},"message":"Service 'good-mysql' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir","https://blog.atomist.com/security-of-docker-kubernetes/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","shortlink":"https://sg.run/e4JE","semgrep.dev":{"rule":{"origin":"community","r_id":10132,"rule_id":"v8U5vN","rv_id":947038,"url":"https://semgrep.dev/playground/r/X0TLZd0/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","version_id":"X0TLZd0"}}},"severity":"WARNING","fingerprint":"b5279ee4ef91563d455863fdcd98b2127132fa5929c3eb79105c7bcc2e3a23310d751ae3de6a1bc0227f7cb000bd07b738de99d15487a190022a401216027346_0","lines":"  good-mysql:","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":39,"col":15,"offset":985},"end":{"line":39,"col":75,"offset":1045},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":9,"offset":8},"abstract_content":"mongoose"},"$I":{"start":{"line":2,"col":5,"offset":37},"end":{"line":2,"col":13,"offset":45},"abstract_content":"mongoose"},"$IMPORT":{"start":{"line":2,"col":25,"offset":57},"end":{"line":2,"col":33,"offset":65},"abstract_content":"mongoose"},"$DB":{"start":{"line":39,"col":5,"offset":975},"end":{"line":39,"col":9,"offset":979},"abstract_content":"User","propagated_value":{"svalue_start":{"line":4,"col":12,"offset":115},"svalue_end":{"line":4,"col":34,"offset":137},"svalue_abstract_content":"mongoose.model('User')"}},"$M":{"start":{"line":39,"col":10,"offset":980},"end":{"line":39,"col":14,"offset":984},"abstract_content":"find"},"$VALUE":{"start":{"line":39,"col":15,"offset":985},"end":{"line":39,"col":75,"offset":1045},"abstract_content":"{username req.body.username password req.body.password}"},"$REQ":{"start":{"line":39,"col":27,"offset":997},"end":{"line":39,"col":30,"offset":1000},"abstract_content":"req"}},"message":"Detected a `mongoose` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"MEDIUM","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-943: Improper Neutralization of Special Elements in Data Query Logic"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","db::sink::sql-or-nosql-query::mongoose","db::sink::sql-or-nosql-query::mongojs","db::sink::sql-or-nosql-query::mongodb"],"owasp":["A01:2017 - Injection"],"references":["https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"],"technology":["express","nodejs","mongodb"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","shortlink":"https://sg.run/Qqxq","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28086,"rule_id":"WAUqgq","rv_id":1152332,"url":"https://semgrep.dev/playground/r/rxT4BDn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","version_id":"rxT4BDn"}}},"severity":"CRITICAL","fingerprint":"921313c41cd8cb97d2851a3967903fb94a2a3ac9de0e92d930776bcc4a94a6196f39457a45880f77958b2ee430ad4ff1e1e259ec68cecc6d3632a899fc6c3966_0","lines":"    User.find({ username: req.body.username, password: req.body.password }, function (err, users) {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":39,"col":27,"offset":997},"end":{"line":39,"col":35,"offset":1005}},"req.body"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":39,"col":15,"offset":985},"end":{"line":39,"col":75,"offset":1045}},"{ username: req.body.username, password: req.body.password }"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.express-child-process.express-child-process","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":161,"col":10,"offset":4287},"end":{"line":161,"col":27,"offset":4304},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":5,"offset":4},"abstract_content":"exec"},"$EXEC":{"start":{"line":11,"col":37,"offset":357},"end":{"line":11,"col":41,"offset":361},"abstract_content":"exec"},"$REQ":{"start":{"line":155,"col":14,"offset":4072},"end":{"line":155,"col":17,"offset":4075},"abstract_content":"req"},"$CP":{"start":{"line":161,"col":5,"offset":4282},"end":{"line":161,"col":9,"offset":4286},"abstract_content":"exec","propagated_value":{"svalue_start":{"line":11,"col":12,"offset":332},"svalue_end":{"line":11,"col":41,"offset":361},"svalue_abstract_content":"require('child_process').exec"}},"$CMD":{"start":{"line":161,"col":10,"offset":4287},"end":{"line":161,"col":27,"offset":4304},"abstract_content":"'identify '+url"}},"message":"Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the user input, and use safe methods for executing the commands. For more information, see [Command injection prevention for JavaScript ] (https://semgrep.dev/docs/cheat-sheets/javascript-command-injection/).","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"MEDIUM","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"cwe2021-top25":true,"cwe2022-top25":true,"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","os::sink::os-command-or-thread:nodejs.child_process"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"],"source-rule-url":"https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js","technology":["javascript","express","nodejs"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/javascript.express.express-child-process.express-child-process","shortlink":"https://sg.run/9p1R","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28867,"rule_id":"L1Uk12","rv_id":1152330,"url":"https://semgrep.dev/playground/r/9lT58J4/javascript.express.express-child-process.express-child-process","version_id":"9lT58J4"}}},"severity":"CRITICAL","fingerprint":"7abcb792c502e332e40fb3fc6e17d527b795a10354d824d23441a51b02affb65619f62e037323f099ecc748a9b3eaf0c7c1f8002e01b8b8e909ad488f34c40ba_0","lines":"    exec('identify ' + url, function (err, stdout, stderr) {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":155,"col":14,"offset":4072},"end":{"line":155,"col":22,"offset":4080}},"req.body"]],"intermediate_vars":[{"location":{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":155,"col":7,"offset":4065},"end":{"line":155,"col":11,"offset":4069}},"content":"item"},{"location":{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":158,"col":9,"offset":4208},"end":{"line":158,"col":12,"offset":4211}},"content":"url"}],"taint_sink":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":161,"col":10,"offset":4287},"end":{"line":161,"col":27,"offset":4304}},"'identify ' + url"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":191,"col":17,"offset":4959},"end":{"line":191,"col":30,"offset":4972},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":9,"offset":8},"abstract_content":"mongoose"},"$I":{"start":{"line":2,"col":5,"offset":37},"end":{"line":2,"col":13,"offset":45},"abstract_content":"mongoose"},"$IMPORT":{"start":{"line":2,"col":25,"offset":57},"end":{"line":2,"col":33,"offset":65},"abstract_content":"mongoose"},"$DB":{"start":{"line":191,"col":3,"offset":4945},"end":{"line":191,"col":7,"offset":4949},"abstract_content":"Todo","propagated_value":{"svalue_start":{"line":3,"col":12,"offset":80},"svalue_end":{"line":3,"col":34,"offset":102},"svalue_abstract_content":"mongoose.model('Todo')"}},"$M":{"start":{"line":191,"col":8,"offset":4950},"end":{"line":191,"col":16,"offset":4958},"abstract_content":"findById"},"$REQ":{"start":{"line":191,"col":17,"offset":4959},"end":{"line":191,"col":20,"offset":4962},"abstract_content":"req"},"$VALUE":{"start":{"line":191,"col":17,"offset":4959},"end":{"line":191,"col":30,"offset":4972},"abstract_content":"req.params.id"}},"message":"Detected a `mongoose` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"MEDIUM","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-943: Improper Neutralization of Special Elements in Data Query Logic"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","db::sink::sql-or-nosql-query::mongoose","db::sink::sql-or-nosql-query::mongojs","db::sink::sql-or-nosql-query::mongodb"],"owasp":["A01:2017 - Injection"],"references":["https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"],"technology":["express","nodejs","mongodb"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","shortlink":"https://sg.run/Qqxq","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28086,"rule_id":"WAUqgq","rv_id":1152332,"url":"https://semgrep.dev/playground/r/rxT4BDn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","version_id":"rxT4BDn"}}},"severity":"CRITICAL","fingerprint":"857b199e1b38094f7f912bca8d4ec0aa6d66a7dd78a0ffd230ce36032ae9a5f9a656092f82f95124cfad6a8487ce3f4e17cdf3d71c7ea82e3386f57ff184d9d2_0","lines":"  Todo.findById(req.params.id, function (err, todo) {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":191,"col":17,"offset":4959},"end":{"line":191,"col":27,"offset":4969}},"req.params"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":191,"col":17,"offset":4959},"end":{"line":191,"col":30,"offset":4972}},"req.params.id"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":219,"col":17,"offset":5498},"end":{"line":219,"col":30,"offset":5511},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":9,"offset":8},"abstract_content":"mongoose"},"$I":{"start":{"line":2,"col":5,"offset":37},"end":{"line":2,"col":13,"offset":45},"abstract_content":"mongoose"},"$IMPORT":{"start":{"line":2,"col":25,"offset":57},"end":{"line":2,"col":33,"offset":65},"abstract_content":"mongoose"},"$DB":{"start":{"line":219,"col":3,"offset":5484},"end":{"line":219,"col":7,"offset":5488},"abstract_content":"Todo","propagated_value":{"svalue_start":{"line":3,"col":12,"offset":80},"svalue_end":{"line":3,"col":34,"offset":102},"svalue_abstract_content":"mongoose.model('Todo')"}},"$M":{"start":{"line":219,"col":8,"offset":5489},"end":{"line":219,"col":16,"offset":5497},"abstract_content":"findById"},"$REQ":{"start":{"line":219,"col":17,"offset":5498},"end":{"line":219,"col":20,"offset":5501},"abstract_content":"req"},"$VALUE":{"start":{"line":219,"col":17,"offset":5498},"end":{"line":219,"col":30,"offset":5511},"abstract_content":"req.params.id"}},"message":"Detected a `mongoose` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"MEDIUM","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-943: Improper Neutralization of Special Elements in Data Query Logic"],"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","db::sink::sql-or-nosql-query::mongoose","db::sink::sql-or-nosql-query::mongojs","db::sink::sql-or-nosql-query::mongodb"],"owasp":["A01:2017 - Injection"],"references":["https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"],"technology":["express","nodejs","mongodb"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","shortlink":"https://sg.run/Qqxq","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28086,"rule_id":"WAUqgq","rv_id":1152332,"url":"https://semgrep.dev/playground/r/rxT4BDn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli","version_id":"rxT4BDn"}}},"severity":"CRITICAL","fingerprint":"857b199e1b38094f7f912bca8d4ec0aa6d66a7dd78a0ffd230ce36032ae9a5f9a656092f82f95124cfad6a8487ce3f4e17cdf3d71c7ea82e3386f57ff184d9d2_1","lines":"  Todo.findById(req.params.id, function (err, todo) {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":219,"col":17,"offset":5498},"end":{"line":219,"col":27,"offset":5508}},"req.params"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js","start":{"line":219,"col":17,"offset":5498},"end":{"line":219,"col":30,"offset":5511}},"req.params.id"]]},"engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","path":"/Users/chad.parnin/repos/nodejs-goof/views/admin.ejs","start":{"line":17,"col":55,"offset":513},"end":{"line":17,"col":74,"offset":532},"extra":{"metavars":{"$1":{"start":{"line":17,"col":71,"offset":529},"end":{"line":17,"col":72,"offset":530},"abstract_content":" "}},"message":"Detected an explicit unescape in an EJS template, using '<%- ... %>' If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. Use '<%= ... %>' to escape this data. If you need escaping, ensure no external data can reach this location.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["http://www.managerjs.com/blog/2015/05/will-ejs-escape-save-me-from-xss-sorta/"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","shortlink":"https://sg.run/dKXQ","semgrep.dev":{"rule":{"origin":"community","r_id":9278,"rule_id":"4bUkPO","rv_id":945812,"url":"https://semgrep.dev/playground/r/A8TJzvw/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","version_id":"A8TJzvw"}}},"severity":"WARNING","fingerprint":"f58573d71b5f3261a9655bbe2e934657fffad271d7f5c21a373bcefe2a0f421877b83aa5e6a25460e646892b91c0ffa6c343fd2fb06281d4e179aa4316b31deb_0","lines":"      <input type=\"hidden\" name=\"redirectPage\" value=\"<%- redirectPage %>\" />","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","path":"/Users/chad.parnin/repos/nodejs-goof/views/index.ejs","start":{"line":20,"col":87,"offset":544},"end":{"line":20,"col":126,"offset":583},"extra":{"metavars":{"$1":{"start":{"line":20,"col":123,"offset":580},"end":{"line":20,"col":124,"offset":581},"abstract_content":" "}},"message":"Detected an explicit unescape in an EJS template, using '<%- ... %>' If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. Use '<%= ... %>' to escape this data. If you need escaping, ensure no external data can reach this location.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["http://www.managerjs.com/blog/2015/05/will-ejs-escape-save-me-from-xss-sorta/"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","shortlink":"https://sg.run/dKXQ","semgrep.dev":{"rule":{"origin":"community","r_id":9278,"rule_id":"4bUkPO","rv_id":945812,"url":"https://semgrep.dev/playground/r/A8TJzvw/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","version_id":"A8TJzvw"}}},"severity":"WARNING","fingerprint":"fdcc06adb0c44b8730d6d3e906d1118a3c8629953633a24690fa834c65e4b929ab2f15c2d52ec34d40a0cae89cc228f5797c0b95168a9532802780b5e0beacf8_0","lines":"    <a class=\"update-link\" href=\"/edit/<%= todo._id %>\" title=\"Update this todo item\"><%- marked(new String(todo.content)) %></a>","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","path":"/Users/chad.parnin/repos/nodejs-goof/views/layout.ejs","start":{"line":12,"col":7,"offset":289},"end":{"line":12,"col":18,"offset":300},"extra":{"metavars":{"$1":{"start":{"line":12,"col":15,"offset":297},"end":{"line":12,"col":16,"offset":298},"abstract_content":" "}},"message":"Detected an explicit unescape in an EJS template, using '<%- ... %>' If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. Use '<%= ... %>' to escape this data. If you need escaping, ensure no external data can reach this location.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["http://www.managerjs.com/blog/2015/05/will-ejs-escape-save-me-from-xss-sorta/"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","shortlink":"https://sg.run/dKXQ","semgrep.dev":{"rule":{"origin":"community","r_id":9278,"rule_id":"4bUkPO","rv_id":945812,"url":"https://semgrep.dev/playground/r/A8TJzvw/javascript.express.security.audit.xss.ejs.explicit-unescape.template-explicit-unescape","version_id":"A8TJzvw"}}},"severity":"WARNING","fingerprint":"6c947ab1c03fa4cd451be3b7dce38f2af35ae7cbf7d6d59586991b82eedcccc750c67073d4fc794cfb6446dd2accfd37387ffb2e31d2571dbf3f3cfad2234d8e_0","lines":"      <%- body %>","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.express.security.audit.xss.mustache.explicit-unescape.template-explicit-unescape","path":"/Users/chad.parnin/repos/nodejs-goof/views/layout.hbs","start":{"line":12,"col":7,"offset":289},"end":{"line":12,"col":17,"offset":299},"extra":{"metavars":{"$1":{"start":{"line":12,"col":13,"offset":295},"end":{"line":12,"col":14,"offset":296},"abstract_content":"y"}},"message":"Detected an explicit unescape in a Mustache template, using triple braces '{{{...}}}' or ampersand '&'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://github.com/janl/mustache.js/#variables","https://ractive.js.org/v0.x/0.7/mustaches#variables"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.xss.mustache.explicit-unescape.template-explicit-unescape","shortlink":"https://sg.run/Lwx9","semgrep.dev":{"rule":{"origin":"community","r_id":9283,"rule_id":"ReUgG1","rv_id":945817,"url":"https://semgrep.dev/playground/r/K3TJbAX/javascript.express.security.audit.xss.mustache.explicit-unescape.template-explicit-unescape","version_id":"K3TJbAX"}}},"severity":"WARNING","fingerprint":"8737c458fc63ca1b69dde7e165ac053edb694bdc299274754fdad3c5300d331ad357feb1054ccee4ebd41126f1c0862ce1b80b1aa31017b8a0a69bfd6ad73c19_0","lines":"      {{{body}}}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/app.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/app.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.express.web.cors-default-config-express.cors-default-config-express","message":"Internal matching error when running javascript.express.web.cors-default-config-express.cors-default-config-express on /Users/chad.parnin/repos/nodejs-goof/app.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/app.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.koa.web.cors-default-config-koa.cors-default-config-koa","message":"Internal matching error when running javascript.koa.web.cors-default-config-koa.cors-default-config-koa on /Users/chad.parnin/repos/nodejs-goof/app.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/app.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/mongoose-db.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/mongoose-db.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.express.web.cors-default-config-express.cors-default-config-express","message":"Internal matching error when running javascript.express.web.cors-default-config-express.cors-default-config-express on /Users/chad.parnin/repos/nodejs-goof/mongoose-db.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/mongoose-db.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.koa.web.cors-default-config-koa.cors-default-config-koa","message":"Internal matching error when running javascript.koa.web.cors-default-config-koa.cors-default-config-koa on /Users/chad.parnin/repos/nodejs-goof/mongoose-db.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/mongoose-db.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/public/js/ga.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/public/js/ga.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/routes/index.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.express.web.cors-default-config-express.cors-default-config-express","message":"Internal matching error when running javascript.express.web.cors-default-config-express.cors-default-config-express on /Users/chad.parnin/repos/nodejs-goof/routes/index.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.koa.web.cors-default-config-koa.cors-default-config-koa","message":"Internal matching error when running javascript.koa.web.cors-default-config-koa.cors-default-config-koa on /Users/chad.parnin/repos/nodejs-goof/routes/index.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/index.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/routes/users.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/users.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.express.web.cors-default-config-express.cors-default-config-express","message":"Internal matching error when running javascript.express.web.cors-default-config-express.cors-default-config-express on /Users/chad.parnin/repos/nodejs-goof/routes/users.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/users.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.koa.web.cors-default-config-koa.cors-default-config-koa","message":"Internal matching error when running javascript.koa.web.cors-default-config-koa.cors-default-config-koa on /Users/chad.parnin/repos/nodejs-goof/routes/users.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/routes/users.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/typeorm-db.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/typeorm-db.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm","message":"Internal matching error when running javascript.crypto-js.cryptojs-weak-algorithm.cryptojs-weak-algorithm on /Users/chad.parnin/repos/nodejs-goof/utils.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/utils.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.express.web.cors-default-config-express.cors-default-config-express","message":"Internal matching error when running javascript.express.web.cors-default-config-express.cors-default-config-express on /Users/chad.parnin/repos/nodejs-goof/utils.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/utils.js"},{"code":2,"level":"warn","type":"Internal matching error","rule_id":"javascript.koa.web.cors-default-config-koa.cors-default-config-koa","message":"Internal matching error when running javascript.koa.web.cors-default-config-koa.cors-default-config-koa on /Users/chad.parnin/repos/nodejs-goof/utils.js:\n An error occurred while invoking the Semgrep engine. Please help us fix this by creating an issue at https://github.com/semgrep/semgrep\n\nmetavariable-name:module(s) operator is only supported in the Pro engine","path":"/Users/chad.parnin/repos/nodejs-goof/utils.js"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/Users/chad.parnin/repos/nodejs-goof/exploits/marked-exploit.sh","start":{"line":2,"col":1,"offset":0},"end":{"line":20,"col":21,"offset":344}}]],"message":"Syntax error at line /Users/chad.parnin/repos/nodejs-goof/exploits/marked-exploit.sh:2:\n `Snyk\n\n# Markdown link\nThis is **markdown**\n\n# Markdown link\n[Snyk](https://snyk.io/)\n\n# Failed XSS\n[Gotcha](javascript:alert(1))\n\n# Failed XSS despite URL encoding\n[Gotcha](javascript&#58;alert(1&#41;)\n\n# Successfull XSS using vuln and browser interpretation\n[Gotcha](javascript&#58this;alert(1&#41;)\n\n# Most boasty exploit\n[Gotcha](javascript&` was unexpected","path":"/Users/chad.parnin/repos/nodejs-goof/exploits/marked-exploit.sh","spans":[{"file":"/Users/chad.parnin/repos/nodejs-goof/exploits/marked-exploit.sh","start":{"line":2,"col":1,"offset":0},"end":{"line":20,"col":21,"offset":344}}]}],"paths":{"scanned":["/Users/chad.parnin/repos/nodejs-goof/.github/CODEOWNERS","/Users/chad.parnin/repos/nodejs-goof/.github/workflows/security-scan.yml","/Users/chad.parnin/repos/nodejs-goof/.gitignore","/Users/chad.parnin/repos/nodejs-goof/Dockerfile","/Users/chad.parnin/repos/nodejs-goof/LICENSE","/Users/chad.parnin/repos/nodejs-goof/README.md","/Users/chad.parnin/repos/nodejs-goof/app.js","/Users/chad.parnin/repos/nodejs-goof/app.json","/Users/chad.parnin/repos/nodejs-goof/deploy-heroku.md","/Users/chad.parnin/repos/nodejs-goof/docker-compose.yml","/Users/chad.parnin/repos/nodejs-goof/entity/Users.js","/Users/chad.parnin/repos/nodejs-goof/example111.json","/Users/chad.parnin/repos/nodejs-goof/exploits/dustjs-exploits.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/exploit-aliases.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/marked-exploit.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/moment-exploit.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/moment-todo-bad.csv","/Users/chad.parnin/repos/nodejs-goof/exploits/moment-todo-good.csv","/Users/chad.parnin/repos/nodejs-goof/exploits/mongoose-exploits.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/ms-exploits.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/nosql-exploits.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/prototype-pollution-typeorm.md","/Users/chad.parnin/repos/nodejs-goof/exploits/prototype-pollution.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/shell-injection.md","/Users/chad.parnin/repos/nodejs-goof/exploits/snyk.png","/Users/chad.parnin/repos/nodejs-goof/exploits/snyk.svg","/Users/chad.parnin/repos/nodejs-goof/exploits/snyk_s.png","/Users/chad.parnin/repos/nodejs-goof/exploits/st-exploits.sh","/Users/chad.parnin/repos/nodejs-goof/exploits/zip-slip/backup.txt","/Users/chad.parnin/repos/nodejs-goof/exploits/zip-slip/malicious_backup.zip","/Users/chad.parnin/repos/nodejs-goof/exploits/zip-slip/my_backup.zip","/Users/chad.parnin/repos/nodejs-goof/mongoose-db.js","/Users/chad.parnin/repos/nodejs-goof/package-lock.json","/Users/chad.parnin/repos/nodejs-goof/package-lock.json.backup","/Users/chad.parnin/repos/nodejs-goof/package.json","/Users/chad.parnin/repos/nodejs-goof/public/about.html","/Users/chad.parnin/repos/nodejs-goof/public/css/screen.css","/Users/chad.parnin/repos/nodejs-goof/public/favicon.ico","/Users/chad.parnin/repos/nodejs-goof/public/images/delete.png","/Users/chad.parnin/repos/nodejs-goof/public/images/dreamerslab.png","/Users/chad.parnin/repos/nodejs-goof/public/images/snyk_patch.jpeg","/Users/chad.parnin/repos/nodejs-goof/public/js/ga.js","/Users/chad.parnin/repos/nodejs-goof/public/robots.txt","/Users/chad.parnin/repos/nodejs-goof/routes/index.js","/Users/chad.parnin/repos/nodejs-goof/routes/users.js","/Users/chad.parnin/repos/nodejs-goof/sarif.json","/Users/chad.parnin/repos/nodejs-goof/service/adminService.js","/Users/chad.parnin/repos/nodejs-goof/typeorm-db.js","/Users/chad.parnin/repos/nodejs-goof/utils.js","/Users/chad.parnin/repos/nodejs-goof/views/about_new.dust","/Users/chad.parnin/repos/nodejs-goof/views/account.hbs","/Users/chad.parnin/repos/nodejs-goof/views/admin.ejs","/Users/chad.parnin/repos/nodejs-goof/views/edit.ejs","/Users/chad.parnin/repos/nodejs-goof/views/index.ejs","/Users/chad.parnin/repos/nodejs-goof/views/layout.ejs","/Users/chad.parnin/repos/nodejs-goof/views/layout.hbs"]},"time":{"rules":[],"rules_parse_time":4.566879034042358,"profiling_times":{"config_time":5.680191993713379,"core_time":5.957400798797607,"ignores_time":0.0010459423065185547,"total_time":11.639055967330933},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.6156470775604248,"per_file_time":{"mean":0.01162336027021888,"std_dev":0.0019390819753717502},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9667652688359144,"rules_selected_ratio":0.1315468940316687,"rules_matched_ratio":0.1315468940316687},"targets":[],"total_bytes":0,"max_memory_bytes":8423417984},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}